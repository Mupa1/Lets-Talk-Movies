<div class="main-content">
  <%= render 'shared/side_nav' %>
  <main>
    <%= render 'shared/navigation' %>
    <div class="main-body">
    <div class="tweets">
      <p class="tweets-heading">TWEETS</p>
      <div class="tweet-form">
        <p>TWEET MOVIE REVIEW</p>
        <%= render 'shared/errors', obj: @opinion %>
        <%= form_for @opinion, url: new_opinion_path  do |f| %>
          <%= f.text_area :Text, class: "text-input", placeholder: "Compose new tweet" %>
          <%= f.submit "Tweet", class: "text-btn" %>
        <% end %>
      </div>
      <div class="tweet-body">
        <p class="tweet-body-header">NEW TWEETS</p>
        <% @opinions.each do |opinion| %>
          <div class="tweet-avatar">
            <div class="picture">
              <% if opinion.Author[:Photo].nil? %>
                <%= gravatar_for opinion.Author, size: 50 %>
              <% else %>
                <%= cl_image_tag opinion.Author.Photo.thumb.url %>
              <% end %>
            </div>
          </div>
          <div class="tweet-content">
            <h4><%= opinion.Author.Fullname.upcase %></h4>
            <span><%= sanitize opinion.Text %></span>
              <span class="like">
                <% if opinion.likes.any? { |like| like.UserId == current_user.id }%>
                  <%= link_to unlike_path(opinion), method: :delete do %>
                    <i class="fas fa-heart text-danger"></i>
                  <% end %>
                <% else %>
                  <%= link_to like_path(opinion) do %>
                    <i class="fas fa-heart"></i>
                  <% end %>
                <% end %>
                <% if opinion.likes.any? %>
                  <p><%= "#{pluralize(opinion.likes.size, 'like')}" %></p>
                <% end %>
            </span>
          </div>
          <div class="clear"></div>
        <% end %>
      </div>
    </div>
  </div> 
  </main>
</div>